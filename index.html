<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Groove Looper</title>
<script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>

<style>
body { 
  background:#0f0f0f; 
  color:white; 
  text-align:center; 
  font-family:sans-serif;
}

h1 { margin-top:40px; }

button {
  padding:12px 24px;
  margin:20px;
  font-size:16px;
  cursor:pointer;
}

.track {
  display:inline-block;
  margin:40px;
}

img {
  width:160px;
  cursor:pointer;
  transition: transform 0.1s ease;
}

img.active {
  transform: scale(1.1);
}
</style>
</head>
<body>

<h1>2 Track Groove Looper</h1>
<button onclick="startTransport()">START</button>

<div class="track">
  <img id="bassImg" src="bass_closed.svg">
  <p>Bass (Q)</p>
</div>

<div class="track">
  <img id="beatImg" src="beat_closed.svg">
  <p>Beat (W)</p>
</div>

<script>

// ==== НАСТРОЙКИ ====
Tone.Transport.bpm.value = 120; // можешь поменять BPM тут

// ==== ЗАГРУЗКА АУДИО ====
const bass = new Tone.Player("bass.mp3").toDestination();
const beat = new Tone.Player("beat.mp3").toDestination();

// ==== СИНХРОНИЗАЦИЯ ====
[bass, beat].forEach(track=>{
  track.loop = true;
  track.sync();
});

// ==== СТАРТ ====
function startTransport(){
  Tone.start();
  Tone.Transport.start();
}

// ==== ПЕРЕКЛЮЧЕНИЕ ====
function toggle(track, imgId, openImg, closedImg){
  const img = document.getElementById(imgId);

  if(track.state === "started"){
    track.stop();
    img.src = closedImg;
    img.classList.remove("active");
  } else {
    track.start(0); // квантование
    img.src = openImg;
    img.classList.add("active");
  }
}

// ==== КЛАВИШИ ====
document.addEventListener("keydown", e=>{
  if(e.key.toLowerCase() === "q"){
    toggle(bass,"bassImg","bass_open.svg","bass_closed.svg");
  }
  if(e.key.toLowerCase() === "w"){
    toggle(beat,"beatImg","beat_open.svg","beat_closed.svg");
  }
});

</script>
</body>
</html>
